.. _node-configuration-datasource-datalogger:

Data Source (data logger)
=========================
|icon-datasource| Data Sources automatically acquire or receive timeseries data using a variety of different transport options. Connect to a :term:`data logger` or collect data from files. Data Sources can be created inside Locations only.

The type of Data Source (data logger or file) is selected at time of creation and cannot be changed. This section is specific to data logger Data Sources.

Refer to the :ref:`Device configuration <device-configuration>` section for a quick guide to connecting a range of industry standard data loggers.

Properties
----------
.. include:: ../properties.rstx


General
~~~~~~~~
The general section allows you to specify the type of data logger you would like to connect to.  

.. raw:: latex

    \vspace{-10pt}

.. only:: not latex

    .. image:: datasource_datalogger_general.jpg
        :scale: 50 %

    | 

.. only:: latex

    | 

    .. image:: datasource_datalogger_general.jpg

Source Enabled
    Uncheck the Source Enabled checkbox to stop collection and prevent alarms and notifications from triggering.

Data logger type
    Select the type of data logger you would like to connect to:

    *Campbell Scientific [PakBus]*

        Model
            Select the model of the data logger.

        PakBus address
            Default value is 1.

        PakBus neighbor
            PakBus neighbor address when using PakBus routing. Leave blank when connecting directly to the end device.

        Security code
            Optional security code pre-conigured in the data logger. Leave blank for none.

        Encryption key
            Optional PakBus encryption key pre-configured in data logger. Leave blank for none.

    *WaterLog*

        Model
            Storm3 is currently the only supported model.

Write mode
    Select how acquired data will be written:
            
    *Merge and overwrite* will insert the acquired data into the existing historic data and overwrite the existing values when timestamps match.
    
    *Merge and preserve* will merge the acquired data into the existing historic data and will not overwrite existing values when timestamps match.

    *Replace existing* will remove all existing historic data within the range of data being acquired.

.. _node-configuration-datasource-datalogger-connection:

Connection
~~~~~~~~~~
Configure how you would like to connect to your data logger.

.. raw:: latex

    \vspace{-10pt}

.. only:: not latex

    .. image:: datasource_datalogger_connection_tcpclient.png
        :scale: 50 %

    | 

.. only:: latex

    | 

    .. image:: datasource_datalogger_connection_tcpclient.png

Transport type
    The following transports are available for certain data loggers:

    *TCP Client*

        TCP Client is used to establish an IP connection to a data logger connected to the internet.

        Internet address
            IP address or Domain name where the device can be contacted.

        TCP Port
            TCP Port of the connected device.

    *TCP Callback*

        TCP Callback allows the remote device to establish an IP connection to eagle.io using a unique identifier. The device should connect to **device.eagle.io** port **4332**.

        Device Id
            The unique identification number generated by the system for this Source. You can use an existing device id if it was previously assigned to a Data Source and no longer in use.

            You can also assign any valid IMEI number from a modem not already assigned to a Source.

    *Scout*

        Scout should be used with a *Scout modem* to enable all the device smart features.

        Device Id
            The unique 15 digit IMEI number assigned to the *Scout modem*. Printed on the back of device.

    *TCP File Server*

        TCP File Server is for use with the WaterLog Storm3 data logger. You should configure your logger to establish a TCP connection to **device.eagle.io** port **32213**.

        Site Id
            The unique identification code generated by the system for this Source. You should configure your device with this Id.


Remote access
    Remote access allows you to connect directly to your data logger over TCP/IP (TCP Callback and Scout transport only). An Internet address and Port will be temporarily allocated when enabling remote access. Scheduled collection, control and configuration will not be available while a remote client is connected, and the Source status will show *REMOTE*.

    Session timeout
        Select a duration for the session, after which the remote access connection will be automatically closed.

    Allow acces from
        Restrict access to your data logger from your current IP address or a range of IP addresses specified using CIDR notation. Select *Anywhere* to allow connections from any Internet enabled device.

    If the remote device is not connected or another client is already connected when you try to connect, a status message will be returned and remote access refused.

.. raw:: latex

    \vspace{-10pt}

.. only:: not latex

    .. image:: datasource_datalogger_connection_remoteaccess.png
        :scale: 50 %

    | 

.. only:: latex

    | 

    .. image:: datasource_datalogger_connection_remoteaccess.png

Retry attempts
    Select how many retry attempts are made during an acquisition or scheduled collection before the communications is considered failed.

Retry delay
    Select the delay between retry attempts. The retry attempts multiplied by the retry delay should not exceed the collection interval.

Communications Alarm
    See :ref:`Alarms and Notifications <communications-alarm>`.

.. raw:: latex

    \newpage

Collection
~~~~~~~~~~
Collection is used to specify if and when data should be automatically collected from the Source. Not all connection transports will have a schedule.

.. raw:: latex

    \vspace{-10pt}

.. only:: not latex

    .. image:: datasource_datalogger_collection.jpg
        :scale: 50 %

    | 

.. only:: latex
    
    | 

    .. image:: datasource_datalogger_collection.jpg

Scheduled
    Enable the schedule for automatic data collection. You should Disable the schedule when using the TCP Callback Transport for event based callbacks (ie. not permanently connected).

Schedule type
    *Server* is the recommended option for always connected devices and allows easy schedule configuration.

    *Remote* enables a *Scout modem* to maintain its own schedule allowing for low power mode and customized configuration.

Collection interval
    Select the frequency of the collection.

Interval offset
    Offset the collection interval to prevent collection occuring on the interval. eg. 1 hour collection interval will occur at 9am, 10am, etc. Set an interval offset of 5 minutes and the collection times will be 9:05am, 10:05am, etc.

Outdated Alarm
    See :ref:`Alarms and Notifications <outdated-alarm>`.

.. raw:: latex

    \newpage


Configuration
~~~~~~~~~~~~~
Configuration displays configuration set in the remote data logger including program name, firmware, etc. To send new configuration to a supported logger, use the :ref:`Manage configuration <operate-manageconfiguration>` dialog.

.. raw:: latex

    \vspace{-10pt}

.. only:: not latex

    .. image:: datasource_datalogger_configuration.jpg
        :scale: 50 %

    | 

.. only:: latex
    
    | 

    .. image:: datasource_datalogger_configuration.jpg

Configuration Alarm
    See :ref:`Alarms and Notifications <configuration-alarm>`.

    
Series
~~~~~~~~~~~
The Series section allows you to assign Series from the Source to New or Existing Parameters.
A list of available tables/series is shown (when not using Automatic parameter configuration) and automatically updated on every connection to the data logger.

.. raw:: latex

    \vspace{-10pt}

.. only:: not latex

    .. image:: datasource_datalogger_series.jpg
        :scale: 50 %

    | 

.. only:: latex
    
    | 

    .. image:: datasource_datalogger_series.jpg


Automatic Parameter Configuration
    Check this option to automatically create, update and disable parameters based on the tables defined in the data logger. When checked, the Source tables will not be displayed.

Location Coordinates
    The Source can optionally provide Location Coordinates from a coordinate series or a pair of numeric series (lat/lng). You need to configure the Location and select this Source to be used for its coordinates. Select the table and series to use from the drop down list.

Configure series
    |icon-table| Re-configure the series/sensors for specific data loggers only.
    
Set acquire time
    |icon-calendar| Set or reset the collection pointer for the corresponding table to re-collect its data from the specified date using the Write mode option selected in the General tab.

Parameter Assignment
    You must assign Series to New or Existing parameters and set the Series for collection by ensuring its checkbox is enabled.
    Any Parameters assigned to Series will be disabled when the Series is unchecked for collection. 

    Parameters can be re-assigned to new Series at any time without loosing existing historic data.

    The series icon indicates the :ref:`type of Parameter <node-types>` that will be created.
    Rename and Delete operations should be performed from the Workspaces Tree.


Historic
~~~~~~~~
Use the *Delete* button to permanently remove all historic data for Parameters contained with the Source. Alternatively use the :ref:`Parameter Historic <node-configuration-parameter-historic>` section to delete historic data for individual Parameters.

.. raw:: latex

    \vspace{-10pt}
    
.. only:: not latex

    .. image:: datasource_historic.jpg
        :scale: 50 %

    | 

.. only:: latex
    
    | 

    .. image:: datasource_historic.jpg


Time
~~~~~
Time allows you to configure the timezone of the Source and associated options.

.. raw:: latex

    \vspace{-10pt}
    
.. only:: not latex

    .. image:: datasource_datalogger_time.jpg
        :scale: 50 %

    | 

.. only:: latex
    
    | 

    .. image:: datasource_datalogger_time.jpg

Timezone
    Select the timezone the Source uses for storing historic data. Choose *(GMT+00:00) UTC* if data timestamps are in UTC.

Automatically adjust clock for Daylight Savings Time
    Check this option if you would like to automatically update the data logger clock to account for DST in the selected timezone.

Automatically update data logger with correct time
    Check this option if you would like to automatically update the data logger clock with the correct time based on the selected timezone.

.. raw:: latex

    \newpage
